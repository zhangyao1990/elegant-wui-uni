var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,n=(a,t,r)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,i=(e,a)=>{for(var t in a||(a={}))o.call(a,t)&&n(e,t,a[t]);if(r)for(var t of r(a))s.call(a,t)&&n(e,t,a[t]);return e},l=(e,r)=>a(e,t(r));import{ak as u,al as c,am as m,an as p}from"./index-CnRAlpd-.js";import{D as f,M as d,c as b,k as y,l as h,m as g,J as F}from"./page-wraper.DMME2CXH.js";const P={PENDING:"pending",LOADING:"loading",SUCCESS:"success",FAIL:"fail"};function v(){let e=null;const a=a=>{a?a.abort():e&&(e.abort(),e=null)};function t(e){return d(e.tempFiles)?e.tempFiles.map((e=>({path:e.path||"",name:e.name||"",size:e.size,type:"image",thumb:e.path||""}))):[{path:e.tempFiles.path||"",name:e.tempFiles.name||"",size:e.tempFiles.size,type:"image",thumb:e.tempFiles.path||""}]}return{startUpload:(t,r)=>{const{uploadMethod:o,formData:s={},action:n,name:u="file",header:c={},fileType:m="image",statusCode:d=200,statusKey:b="status",abortPrevious:y=!1}=r;t[b]=P.LOADING;const h={action:n,header:c,name:u,fileName:u,fileType:m,statusCode:d,abortPrevious:y,onSuccess:(a,t,o)=>{var s;t[b]=P.SUCCESS,e=null,null==(s=r.onSuccess)||s.call(r,a,t,o)},onError:(a,t,o)=>{var s;t[b]=P.FAIL,t.error=a.errMsg,e=null,null==(s=r.onError)||s.call(r,a,t,o)},onProgress:(e,a)=>{var t;a.percent=e.progress,null==(t=r.onProgress)||t.call(r,e,a)}};return f(o)?o(t,s,h):((t,r,o)=>{o.abortPrevious&&a();const s=p({url:o.action,header:o.header,name:o.name,fileName:o.name,fileType:o.fileType,formData:r,filePath:t.url,success(e){e.statusCode===o.statusCode?o.onSuccess(e,t,r):o.onError(l(i({},e),{errMsg:e.errMsg||""}),t,r)},fail(e){o.onError(e,t,r)}});return e=s,s.onProgressUpdate((e=>{o.onProgress(e,t)})),s})(t,s,h)},abort:a,UPLOAD_STATUS:P,chooseFile:function({multiple:e,sizeType:a,sourceType:r,maxCount:o,accept:s,compressed:n,maxDuration:i,camera:l,extension:p}){return new Promise(((f,d)=>{switch(s){case"image":default:u({count:e?Math.min(o||9,9):1,sizeType:a,sourceType:r,extension:p,success:e=>f(t(e)),fail:d});break;case"video":m({sourceType:r,compressed:n,maxDuration:i,camera:l,extension:p,success:e=>f(function(e){return[{path:e.tempFilePath||e.filePath||"",name:e.name||"",size:e.size,type:"video",thumb:e.thumbTempFilePath||"",duration:e.duration}]}(e)),fail:d});break;case"all":c({count:e?Math.min(o||100,100):1,type:s,extension:p,success:e=>f(e.tempFiles),fail:d})}}))}}}const S=l(i({},b),{fileList:F(),action:h(""),header:{type:Object,default:()=>({})},multiple:y(!1),disabled:y(!1),limit:Number,showLimitNum:y(!0),maxSize:g(Number.MAX_VALUE),sourceType:{type:Array,default:()=>["album","camera"]},sizeType:{type:Array,default:()=>["original","compressed"]},name:h("file"),formData:{type:Object,default:()=>({})},onPreviewFail:Function,beforeUpload:Function,beforeChoose:Function,beforeRemove:Function,beforePreview:Function,buildFormData:Function,loadingType:h("ring"),loadingColor:h("#ffffff"),accept:h("image"),statusKey:h("status"),loadingSize:h("24px"),compressed:y(!0),maxDuration:g(60),camera:h("back"),imageMode:h("aspectFit"),successStatus:g(200),customEvokeClass:h(""),customPreviewClass:h(""),autoUpload:y(!0),reupload:y(!1),uploadMethod:Function,extension:Array});export{v as a,S as u};
