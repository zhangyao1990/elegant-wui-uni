var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,n=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,o=(e,a)=>{for(var t in a||(a={}))r.call(a,t)&&n(e,t,a[t]);if(l)for(var t of l(a))s.call(a,t)&&n(e,t,a[t]);return e},i=(e,l)=>a(e,t(l));import{d as u,r as d,c,z as m,e as f,f as w,a as p,g,w as h,x as v,h as y,i as _,A as D,s as b,B as k,k as Y,t as C,u as F,n as x,F as $,p as M}from"./index-CnRAlpd-.js";import{_ as V,a as S}from"./wui-tabs.DpvbSOfY.js";import{_ as T}from"./wui-tag.DyG6ZpzK.js";import{m as O,c as j,k as P,l as W,J as I,v as z,N as A,Q as q,M as R,d as B,O as H,b as L,V as N,y as U,P as E,a as G}from"./page-wraper.DMME2CXH.js";import{i as J,_ as Q,g as K}from"./wui-calendar-view.Df2-w_We.js";import{_ as X}from"./wui-action-sheet.CrdI8UKt.js";import{_ as Z}from"./wui-button.Bcr_H9ae.js";import{d as ee}from"./dayjs.CzhXVd04.js";import{u as ae}from"./useTranslate.DCsJG8gA.js";const te=i(o({},j),{modelValue:z([Number,Array,null]),type:W("date"),minDate:O(new Date((new Date).getFullYear(),(new Date).getMonth()-6,(new Date).getDate()).getTime()),maxDate:O(new Date((new Date).getFullYear(),(new Date).getMonth()+6,(new Date).getDate(),23,59,59).getTime()),firstDayOfWeek:O(0),formatter:Function,maxRange:Number,rangePrompt:String,allowSameDay:P(!1),defaultTime:{type:[String,Array]},timeFilter:Function,hideSecond:P(!1),label:String,labelWidth:String,disabled:P(!1),readonly:P(!1),placeholder:String,title:String,alignRight:P(!1),error:P(!1),required:P(!1),size:String,center:P(!1),closeOnClickModal:P(!0),zIndex:O(15),showConfirm:P(!0),confirmText:String,displayFormat:Function,innerDisplayFormat:Function,ellipsis:P(!1),showTypeSwitch:P(!1),shortcuts:I(),onShortcutsClick:Function,safeAreaInsetBottom:P(!0),beforeConfirm:Function,prop:String,rules:I(),customViewClass:W(""),customLabelClass:W(""),customValueClass:W(""),immediateChange:P(!1),withCell:P(!0)}),le=G(u(i(o({},{name:"wui-calendar",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:te,emits:["cancel","change","update:modelValue","confirm","open"],setup(e,{expose:a,emit:t}){const{translate:l}=ae("calendar"),r=(e,a)=>{switch(a){case"date":return ee(e).format("YYYY-MM-DD");case"dates":return e.map((e=>ee(e).format("YYYY-MM-DD"))).join(", ");case"daterange":return`${e[0]?ee(e[0]).format("YYYY-MM-DD"):l("startTime")} ${l("to")} ${e[1]?ee(e[1]).format("YYYY-MM-DD"):l("endTime")}`;case"datetime":return ee(e).format("YYYY-MM-DD HH:mm:ss");case"datetimerange":return`${e[0]?ee(e[0]).format(l("timeFormat")):l("startTime")} ${l("to")}\n${e[1]?ee(e[1]).format(l("timeFormat")):l("endTime")}`;case"week":{const a=new Date(e),t=a.getFullYear(),r=K(e);new Date(a).setDate(a.getDate()-a.getDay()+1);const s=new Date(a);s.setDate(a.getDate()+(7-a.getDay()));const n=s.getFullYear()>t?s.getFullYear():t;return l("weekFormat",n,N(r))}case"weekrange":{const a=new Date(e[0]),t=new Date(e[1]),r=a.getFullYear(),s=t.getFullYear(),n=K(e[0]),o=K(e[1]);new Date(a).setDate(a.getDate()-a.getDay()+1);const i=new Date(a);i.setDate(a.getDate()+(7-a.getDay()));new Date(t).setDate(t.getDate()-t.getDay()+1);const u=new Date(t);u.setDate(t.getDate()+(7-t.getDay()));const d=i.getFullYear()>r?i.getFullYear():r,c=u.getFullYear()>s?u.getFullYear():s;return`${e[0]?l("weekFormat",d,N(n)):l("startWeek")} - ${e[1]?l("weekFormat",c,N(o)):l("endWeek")}`}case"month":return ee(e).format("YYYY / MM");case"monthrange":return`${e[0]?ee(e[0]).format("YYYY / MM"):l("startMonth")} ${l("to")} ${e[1]?ee(e[1]).format("YYYY / MM"):l("endMonth")}`}},s=(e,a,t)=>{switch(t){case"daterange":return e?ee(e).format(l("dateFormat")):l("end"===a?"endTime":"startTime");case"datetimerange":return e?ee(e).format(l("timeFormat")):l("end"===a?"endTime":"startTime");case"weekrange":{if(!e)return l("end"===a?"endWeek":"startWeek");const t=new Date(e).getFullYear(),r=K(e);return l("weekFormat",t,N(r))}case"monthrange":return e?ee(e).format(l("monthFormat")):l("end"===a?"endMonth":"startMonth")}},n=e,o=t,i=d(!1),u=d(null),O=d(null),j=d(338),P=d(!0),W=d(0),I=d(0),z=d("date"),G=d(),te=d(!1),le=A(),re=d(),se=d(),ne=c((()=>{const[e,a]=q(R(u.value)?u.value:[]);return[e,a].map(((e,a)=>(n.innerDisplayFormat||s)(e,0===a?"start":"end",z.value)))})),oe=c((()=>!R(n.modelValue)&&n.modelValue||R(n.modelValue)&&n.modelValue.length?(n.displayFormat||r)(n.modelValue,G.value||z.value):""));m((()=>n.modelValue),((e,a)=>{E(e,a)||(u.value=q(e),P.value=pe(e))}),{immediate:!0}),m((()=>n.type),((e,a)=>{if(n.showTypeSwitch){const a=["date","week","month"],t=["daterange","weekrange","monthrange"],l=e.indexOf("range")>-1?t.indexOf(e)||0:a.indexOf(e);W.value=l}j.value=n.showConfirm?338:400,z.value=q(e)}),{deep:!0,immediate:!0}),m((()=>n.showConfirm),(e=>{j.value=e?338:400}),{deep:!0,immediate:!0});const{parent:ie}=B(H),ue=c((()=>ie&&n.prop&&ie.errorMessages&&ie.errorMessages[n.prop]?ie.errorMessages[n.prop]:"")),de=c((()=>{let e=!1;if(ie&&ie.props.rules){const a=ie.props.rules;for(const t in a)Object.prototype.hasOwnProperty.call(a,t)&&t===n.prop&&Array.isArray(a[t])&&(e=a[t].some((e=>e.required)))}return n.required||n.rules.some((e=>e.required))||e})),ce=c((()=>e=>J(e)));function me(){return e=this,a=null,t=function*(){const{disabled:e,readonly:a}=n;e||a||(te.value=!0,i.value=!0,O.value=q(u.value),I.value=W.value,G.value=z.value,yield U(),re.value&&re.value&&re.value.$.exposed.scrollIntoView(),setTimeout((()=>{n.showTypeSwitch&&(se.value.scrollIntoView(),se.value.updateLineStyle(!1))}),250),o("open"))},new Promise(((l,r)=>{var s=e=>{try{o(t.next(e))}catch(a){r(a)}},n=e=>{try{o(t.throw(e))}catch(a){r(a)}},o=e=>e.done?l(e.value):Promise.resolve(e.value).then(s,n);o((t=t.apply(e,a)).next())}));var e,a,t}function fe(){i.value=!1,setTimeout((()=>{u.value=q(O.value),W.value=I.value,z.value=G.value||"date",P.value=pe(O.value)}),250),o("cancel")}function we({index:e}){const a=n.type.indexOf("range")>-1?["daterange","weekrange","monthrange"][e]:["date","week","month"][e];W.value=e,z.value=a}function pe(e){let a=!1;return(!(n.type.indexOf("range")>-1)||R(e)&&e[0]&&e[1]&&e)&&("dates"!==n.type||R(e)&&0!==e.length&&e)&&e||(a=!0),a}function ge({value:e}){u.value=q(e),P.value=pe(e),o("change",{value:e}),n.showConfirm||P.value||he()}function he(){n.beforeConfirm?n.beforeConfirm({value:u.value,resolve:e=>{e&&ve()}}):ve()}function ve(){i.value=!1,G.value=z.value,o("update:modelValue",u.value),o("confirm",{value:u.value,type:z.value})}return a({close:fe,open:me}),(e,a)=>{const t=_,r=f(w("wui-tab"),V),s=f(w("wui-tabs"),S),o=f(w("wui-tag"),T);return g(),p(t,{class:b(`wui-calendar ${F(le).border.value?"is-border":""} ${e.customClass}`)},{default:h((()=>[e.withCell?(g(),p(t,{key:0,class:"wui-calendar__field",onClick:me},{default:h((()=>[e.$slots.default?D(e.$slots,"default",{key:0},void 0,!0):(g(),p(t,{key:1,class:b(`wui-calendar__cell ${e.disabled?"is-disabled":""} ${n.readonly?"is-readonly":""} ${e.alignRight?"is-align-right":""} ${e.error?"is-error":""} ${e.size?"is-"+e.size:""} ${e.center?"is-center":""}`)},{default:h((()=>[e.label||e.$slots.label?(g(),p(t,{key:0,class:b(`wui-calendar__label ${de.value?"is-required":""} ${e.customLabelClass}`),style:k(e.labelWidth?"min-width:"+e.labelWidth+";max-width:"+e.labelWidth+";":"")},{default:h((()=>[D(e.$slots,"label",{},(()=>[Y(C(e.label),1)]),!0)])),_:3},8,["class","style"])):v("",!0),y(t,{class:"wui-calendar__body"},{default:h((()=>[y(t,{class:"wui-calendar__value-wraper"},{default:h((()=>[y(t,{class:b(`wui-calendar__value ${e.ellipsis?"is-ellipsis":""} ${e.customValueClass} ${oe.value?"":"wui-calendar__value--placeholder"}`)},{default:h((()=>[Y(C(oe.value||e.placeholder||F(l)("placeholder")),1)])),_:1},8,["class"]),e.disabled||e.readonly?v("",!0):(g(),p(L,{key:0,"custom-class":"wui-calendar__arrow",name:"arrow-right"}))])),_:1}),ue.value?(g(),p(t,{key:0,class:"wui-calendar__error-message"},{default:h((()=>[Y(C(ue.value),1)])),_:1})):v("",!0)])),_:1})])),_:3},8,["class"]))])),_:3})):v("",!0),y(X,{modelValue:i.value,"onUpdate:modelValue":a[2]||(a[2]=e=>i.value=e),duration:250,"close-on-click-modal":e.closeOnClickModal,"safe-area-inset-bottom":e.safeAreaInsetBottom,"z-index":e.zIndex,onClose:fe},{default:h((()=>[y(t,{class:"wui-calendar__header"},{default:h((()=>[e.showTypeSwitch||0!==e.shortcuts.length?v("",!0):(g(),p(t,{key:0,class:"wui-calendar__title"},{default:h((()=>[Y(C(e.title||F(l)("title")),1)])),_:1})),e.showTypeSwitch?(g(),p(t,{key:1,class:"wui-calendar__tabs"},{default:h((()=>[y(s,{ref_key:"calendarTabs",ref:se,modelValue:W.value,"onUpdate:modelValue":a[0]||(a[0]=e=>W.value=e),onChange:we},{default:h((()=>[y(r,{title:F(l)("day"),name:F(l)("day")},null,8,["title","name"]),y(r,{title:F(l)("week"),name:F(l)("week")},null,8,["title","name"]),y(r,{title:F(l)("month"),name:F(l)("month")},null,8,["title","name"])])),_:1},8,["modelValue"])])),_:1})):v("",!0),e.shortcuts.length>0?(g(),p(t,{key:2,class:"wui-calendar__shortcuts"},{default:h((()=>[(g(!0),x($,null,M(e.shortcuts,((e,a)=>(g(),p(o,{key:a,"custom-class":"wui-calendar__tag",type:"primary",plain:"",round:"",onClick:e=>function(e){n.onShortcutsClick&&"function"==typeof n.onShortcutsClick&&(u.value=q(n.onShortcutsClick({item:n.shortcuts[e],index:e})),P.value=pe(u.value)),n.showConfirm||he()}(a)},{default:h((()=>[Y(C(e.text),1)])),_:2},1032,["onClick"])))),128))])),_:1})):v("",!0),y(L,{"custom-class":"wui-calendar__close",name:"add",onClick:fe})])),_:1}),te.value?(g(),p(t,{key:0,class:b(`wui-calendar__view  ${z.value.indexOf("range")>-1?"is-range":""} ${e.showConfirm?"is-show-confirm":""}`)},{default:h((()=>[ce.value(e.type)?(g(),p(t,{key:0,class:b("wui-calendar__range-label "+("monthrange"===e.type?"is-monthrange":""))},{default:h((()=>[y(t,{class:b("wui-calendar__range-label-item "+(u.value&&F(R)(u.value)&&u.value[0]?"":"is-placeholder")),style:{"text-align":"right"}},{default:h((()=>[Y(C(ne.value[0]),1)])),_:1},8,["class"]),y(t,{class:"wui-calendar__range-sperator"},{default:h((()=>[Y("/")])),_:1}),y(t,{class:b("wui-calendar__range-label-item "+(u.value&&F(R)(u.value)&&u.value[1]?"":"is-placeholder"))},{default:h((()=>[Y(C(ne.value[1]),1)])),_:1},8,["class"])])),_:1},8,["class"])):v("",!0),y(Q,{ref_key:"calendarView",ref:re,modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=e=>u.value=e),type:z.value,"min-date":e.minDate,"max-date":e.maxDate,"first-day-of-week":e.firstDayOfWeek,formatter:e.formatter,"panel-height":j.value,"max-range":e.maxRange,"range-prompt":e.rangePrompt,"allow-same-day":e.allowSameDay,"default-time":e.defaultTime,"time-filter":e.timeFilter,"hide-second":e.hideSecond,"show-panel-title":!ce.value(e.type),"immediate-change":e.immediateChange,onChange:ge},null,8,["modelValue","type","min-date","max-date","first-day-of-week","formatter","panel-height","max-range","range-prompt","allow-same-day","default-time","time-filter","hide-second","show-panel-title","immediate-change"])])),_:1},8,["class"])):v("",!0),e.showConfirm?(g(),p(t,{key:1,class:"wui-calendar__confirm"},{default:h((()=>[y(Z,{block:"",disabled:P.value,onClick:he},{default:h((()=>[Y(C(e.confirmText||F(l)("confirm")),1)])),_:1},8,["disabled"])])),_:1})):v("",!0)])),_:1},8,["modelValue","close-on-click-modal","safe-area-inset-bottom","z-index"])])),_:3},8,["class"])}}})),[["__scopeId","data-v-5a687da9"]]);export{le as _};
