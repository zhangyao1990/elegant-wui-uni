var e=Object.defineProperty,s=Object.defineProperties,r=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,n=(s,r,o)=>r in s?e(s,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[r]=o,p=(e,s)=>{var r={};for(var n in e)a.call(e,n)&&s.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&o)for(var n of o(e))s.indexOf(n)<0&&t.call(e,n)&&(r[n]=e[n]);return r};import{d as l,I as i,z as c,a as u,g as f,w as m,A as d,x as g,B as h,s as y,i as v}from"./index-7V_Oz7o2.js";import{a3 as b,f as O,O as w,g as j,M as x,n as P,H as k,Y as E,a0 as C,Q as I,a as _}from"./page-wraper.XTDu10FG.js";import{u as T}from"./useChildren.CE-WdV6D.js";const A=l((B=((e,s)=>{for(var r in s||(s={}))a.call(s,r)&&n(e,r,s[r]);if(o)for(var r of o(s))t.call(s,r)&&n(e,r,s[r]);return e})({},{name:"wui-form",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),H={props:b,setup(e,{expose:s}){const{show:r}=O("wui-form-toast"),o=e,{children:a,linkChildren:t}=T(w);let n=i({});function l(e){e?n[e]="":Object.keys(n).forEach((e=>{n[e]=""}))}return t({props:o,errorMessages:n}),c((()=>o.model),(()=>{o.resetOnChange&&l()}),{immediate:!0,deep:!0}),s({validate:function(e){return s=this,t=null,i=function*(){const s=[];let t=!0;const i=[],c=function(){const e=I(o.rules),s=a.map((e=>e.prop));return Object.keys(e).forEach((r=>{s.includes(r)||delete e[r]})),a.forEach((s=>{P(s.prop)&&P(s.rules)&&s.rules.length&&(e[s.prop]?e[s.prop]=[...e[s.prop],...s.rules]:e[s.prop]=s.rules)})),e}(),u=x(e)?e:P(e)?[e]:[],f=u.length>0?u.reduce(((e,s)=>(c[s]&&(e[s]=c[s]),e)),{}):c;for(const e in f){const r=f[e],a=k(o.model,e);if(r&&r.length>0)for(const o of r){if(o.required&&(!P(a)||""===a)){s.push({prop:e,message:o.message}),t=!1;break}if(o.pattern&&!o.pattern.test(a)){s.push({prop:e,message:o.message}),t=!1;break}const r=o,{validator:n}=r,l=p(r,["validator"]);if(n){const r=n(a,l);E(r)?i.push(r.then((r=>{"string"==typeof r?(s.push({prop:e,message:r}),t=!1):"boolean"!=typeof r||r||(s.push({prop:e,message:o.message}),t=!1)})).catch((r=>{const a=P(r)?C(r)?r:r.message||o.message:o.message;s.push({prop:e,message:a}),t=!1}))):r||(s.push({prop:e,message:o.message}),t=!1)}}}return yield Promise.all(i),function(e){const s=a.map((e=>e.prop)).filter(Boolean),t=e.filter((e=>e.message&&s.includes(e.prop)));t.length&&(t.sort(((e,r)=>s.indexOf(e.prop)-s.indexOf(r.prop))),"toast"===o.errorType?r(t[0].message):"message"===o.errorType&&t.forEach((e=>{n[e.prop]=e.message})))}(s),t&&(u.length?u.forEach(l):l()),{valid:t,errors:s}},new Promise(((e,r)=>{var o=e=>{try{n(i.next(e))}catch(s){r(s)}},a=e=>{try{n(i.throw(e))}catch(s){r(s)}},n=s=>s.done?e(s.value):Promise.resolve(s.value).then(o,a);n((i=i.apply(s,t)).next())}));var s,t,i},reset:function(){l()}}),(e,s)=>{const r=v;return f(),u(r,{class:y(`wui-form ${e.customClass}`),style:h(e.customStyle)},{default:m((()=>[d(e.$slots,"default",{},void 0,!0),"toast"===o.errorType?(f(),u(j,{key:0,selector:"wui-form-toast"})):g("",!0)])),_:3},8,["class","style"])}}},s(B,r(H))));var B,H;const M=_(A,[["__scopeId","data-v-d38ea470"]]);export{M as _};
