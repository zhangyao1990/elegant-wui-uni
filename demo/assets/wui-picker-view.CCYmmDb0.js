var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,u=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,r=(e,a)=>{for(var t in a||(a={}))n.call(a,t)&&u(e,t,a[t]);if(l)for(var t of l(a))o.call(a,t)&&u(e,t,a[t]);return e},s=(e,l)=>a(e,t(l));import{d as i,r as c,z as d,H as v,a as m,g as p,i as f,B as g,s as h,w as y,x as b,h as w,a9 as k,n as x,p as _,aa as C,F as K,k as O,t as $,O as P}from"./index-CnRAlpd-.js";import{J as j,k as I,l as S,m as E,c as V,M as D,R as H,x as A,K as F,Q as T,$ as z,P as B,n as N,a as R}from"./page-wraper.DMME2CXH.js";const q=s(r({},V),{loading:I(!1),loadingColor:S("#4D80F0"),columnsHeight:E(217),valueKey:S("value"),labelKey:S("label"),immediateChange:I(!1),modelValue:{type:[String,Number,Boolean,Array,Array,Array],default:"",required:!0},columns:j(),columnChange:Function});function G(e,a,t){let l=D(e)?e:[e];const n=new Set(e.map(H));if(1!==n.size&&n.has("object"))throw Error("The columns are correct");D(e[0])||(l=[l]);return l.map((e=>e.map((e=>{if(!A(e))return{[a]:e,[t]:e};if(!e.hasOwnProperty(a)&&!e.hasOwnProperty(t))throw Error("Can't find valueKey and labelKey in columns");return e.hasOwnProperty(t)||(e[t]=e[a]),e.hasOwnProperty(a)||(e[a]=e[t]),e}))))}const J=R(i(s(r({},{name:"wui-picker-view",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:q,emits:["change","pickstart","pickend","update:modelValue"],setup(e,{expose:a,emit:t}){const l=e,n=t,o=c([]),u=c(35),r=c([]);d([()=>l.modelValue,()=>l.columns],((e,a)=>{B(a[1],e[1])||(D(e[1])&&e[1].length>0?o.value=G(e[1],l.valueKey,l.labelKey):(o.value=[],r.value=[])),N(e[0])&&function(e){if(0===o.value.length)return void(r.value=[]);(""===e||!N(e)||D(e)&&0===e.length)&&(e=o.value.map((e=>e[0][l.valueKey])));const a=H(e),t=["string","number","boolean","array"];-1===t.indexOf(a)&&console.error(`value must be one of ${t.toString()}`);e=(e=D(e)?e:[e]).slice(0,o.value.length);let n=T(r.value);e.forEach(((e,a)=>{let t=o.value[a].findIndex((a=>a[l.valueKey].toString()===e.toString()));t=-1===t?0:t,n=i(a,t,n)})),r.value=n.slice(0,e.length)}(e[0])}),{deep:!0,immediate:!0});const{proxy:s}=v();function i(e,a,t){const l=o.value[e];if(!l||!l[a])throw Error(`The value to select with Col:${e} Row:${a} is incorrect`);const n=T(t);if(n[e]=a,l[a].disabled){const t=l.slice(0,a).reverse().findIndex((e=>!e.disabled)),o=l.slice(a+1).findIndex((e=>!e.disabled));-1!==t?n[e]=a-1-t:-1!==o?n[e]=a+1+o:void 0===n[e]&&(n[e]=0)}return n}function j({detail:{value:e}}){const a=function(e){e=e.slice(0,o.value.length);const a=T(r.value);let t=T(r.value);e.forEach(((e,l)=>{(e=z(e,0,o.value[l].length-1))!==a[l]&&(t=i(l,e,t))}));const l=function(e,a){if(!e||!a)return-1;const t=e.findIndex(((e,t)=>e!==a[t]));return t}(t,a);if(-1===l)return;const n=t[l];return 1===t.length?n:l}(e=e.map((e=>Number(e||0))));r.value=T(e),P((()=>{r.value=function(e){let a=T(e);return e.forEach(((e,t)=>{e=z(e,0,o.value[t].length-1),a=i(t,e,a)})),a}(e),l.columnChange?l.columnChange.length<4?(l.columnChange(s.$.exposed,S(),a||0,(()=>{})),I(a||0)):l.columnChange(s.$.exposed,S(),a||0,(()=>{I(a||0)})):I(a||0)}))}function I(e){const a=E();B(a,l.modelValue)||(n("update:modelValue",a),setTimeout((()=>{n("change",{picker:s.$.exposed,value:a,index:e})}),0))}function S(){const e=r.value.map(((e,a)=>o.value[a][e]));return 1===e.length?e[0]:e}function E(){const{valueKey:e}=l,a=r.value.map(((a,t)=>o.value[t][a][e]));return 1===a.length?a[0]:a}function V(){n("pickstart")}function A(){n("pickend")}return a({getSelects:S,getValues:E,setColumnData:function(e,a,t=0){o.value[e]=G(a,l.valueKey,l.labelKey).reduce(((e,a)=>e.concat(a)),[]),r.value=i(e,t,r.value)},getColumnsData:function(){return T(o.value)},getColumnData:function(e){return o.value[e]},getColumnIndex:function(e){return r.value[e]},getLabels:function(){const{labelKey:e}=l;return r.value.map(((a,t)=>o.value[t][a][e]))},getSelectedIndex:function(){return r.value},resetColumns:function(e){D(e)&&e.length&&(o.value=G(e,l.valueKey,l.labelKey))}}),(e,a)=>{const t=f,l=C,n=k;return p(),m(t,{class:h(`wui-picker-view ${e.customClass}`),style:g(e.customStyle)},{default:y((()=>[e.loading?(p(),m(t,{key:0,class:"wui-picker-view__loading"},{default:y((()=>[w(F,{color:e.loadingColor},null,8,["color"])])),_:1})):b("",!0),w(t,{style:g(`height: ${e.columnsHeight-20}px;`)},{default:y((()=>[w(n,{"mask-class":"wui-picker-view__mask","indicator-class":"wui-picker-view__roller","indicator-style":`height: ${u.value}px;`,style:g(`height: ${e.columnsHeight-20}px;`),value:r.value,"immediate-change":e.immediateChange,onChange:j,onPickstart:V,onPickend:A},{default:y((()=>[(p(!0),x(K,null,_(o.value,((a,n)=>(p(),m(l,{key:n,class:"wui-picker-view-column"},{default:y((()=>[(p(!0),x(K,null,_(a,((a,l)=>(p(),m(t,{key:l,class:h(`wui-picker-view-column__item ${a.disabled?"wui-picker-view-column__item--disabled":""}  ${r.value[n]==l?"wui-picker-view-column__item--active":""}`),style:g(`line-height: ${u.value}px;`)},{default:y((()=>[O($(a[e.labelKey]),1)])),_:2},1032,["class","style"])))),128))])),_:2},1024)))),128))])),_:1},8,["indicator-style","style","value","immediate-change"])])),_:1},8,["style"])])),_:1},8,["class","style"])}}})),[["__scopeId","data-v-bb9478d3"]]);export{J as _,G as f};
