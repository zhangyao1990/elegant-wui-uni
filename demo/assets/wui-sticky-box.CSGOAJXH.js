var t=Object.defineProperty,e=Object.defineProperties,o=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,n=(e,o,s)=>o in e?t(e,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[o]=s,l=(t,e)=>{for(var o in e||(e={}))i.call(e,o)&&n(t,o,e[o]);if(s)for(var o of s(e))a.call(e,o)&&n(t,o,e[o]);return t},r=(t,s)=>e(t,o(s));import{d as u,r as c,I as d,H as h,c as p,a as f,g as b,i as v,B as y,w as m,h as w,A as g,s as x,ae as $,Z as k}from"./index-7V_Oz7o2.js";import{w as _}from"./wui-resize.CqAgl2MN.js";import{m as C,c as S,E as P,d as j,e as I,o as O,y as z,p as T,a as R}from"./page-wraper.XTDu10FG.js";import{u as L}from"./useChildren.CE-WdV6D.js";const N=r(l({},S),{zIndex:C(1),offsetTop:C(0)}),E=Symbol("wui-sticky-box"),F=R(u(r(l({},{name:"wui-sticky",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:N,setup(t,{expose:e}){const o=t,s=c(`wui-sticky${P()}`),i=c([]),a=d({position:"absolute",boxLeaved:!1,top:0,height:0,width:0,state:""}),{parent:n}=j(E),{proxy:l}=h(),r=p((()=>{const t={"z-index":o.zIndex,height:I(a.height),width:I(a.width)};return a.boxLeaved||(t.position="relative"),`${O(t)};${o.customStyle}`})),u=p((()=>{const t={"z-index":o.zIndex,height:I(a.height),width:I(a.width)};return a.boxLeaved||(t.position="relative"),`${O(t)};`})),k=p((()=>{const t={position:a.position,top:I(a.top)};return O(t)})),C=p((()=>{let t=0;return t=44,44+o.offsetTop}));function S(t){return e=this,o=null,r=function*(){a.width=t.width,a.height=t.height,yield z(),function(){if(0===a.height&&0===a.width)return;const t=C.value+a.height;(function(){for(;0!==i.value.length;)i.value.pop().disconnect()})(),function(){const t=$(l,{thresholds:[0,.5]});return i.value.push(t),t}().relativeToViewport({top:-t}).observe(`#${s.value}`,(t=>{R(t)})),T(`#${s.value}`,!1,l).then((e=>{e.bottom=Number(e.bottom)+44,Number(e.bottom)<=t&&R({boundingClientRect:e})}))}(),n&&n.observerForChild&&n.observerForChild(l)},new Promise(((t,s)=>{var i=t=>{try{n(r.next(t))}catch(e){s(e)}},a=t=>{try{n(r.throw(t))}catch(e){s(e)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(i,a);n((r=r.apply(e,o)).next())}));var e,o,r}function R({boundingClientRect:t}){if(n&&a.height>=n.boxStyle.height)return a.position="absolute",void(a.top=0);let e=t.top<=C.value;e=t.top<C.value,e?(a.state="sticky",a.boxLeaved=!1,a.position="fixed",a.top=C.value):(a.state="normal",a.boxLeaved=!1,a.position="absolute",a.top=0)}return e({setPosition:function(t,e,o){a.boxLeaved=t,a.position=e,a.top=o},stickyState:a,offsetTop:o.offsetTop}),(t,e)=>{const o=v;return b(),f(o,{style:y(`${r.value};display: inline-block;`)},{default:m((()=>[w(o,{class:x(`wui-sticky ${t.customClass}`),style:y(u.value),id:s.value},{default:m((()=>[w(o,{class:"wui-sticky__container",style:y(k.value)},{default:m((()=>[w(_,{onResize:S,"custom-style":"display: inline-block;"},{default:m((()=>[g(t.$slots,"default",{},void 0,!0)])),_:3})])),_:3},8,["style"])])),_:3},8,["class","style","id"])])),_:3},8,["style"])}}})),[["__scopeId","data-v-a170594c"]]),M=R(u(r(l({},{name:"wui-sticky-box",options:{addGlobalClass:!0,styleIsolation:"shared"}}),{props:S,setup(t){const e=t,o=c(`wui-sticky-box${P()}`),s=c(new Map),i=d({height:0,width:0}),{proxy:a}=h(),{children:n,linkChildren:l}=L(E);function r(t){i.width=t.width,i.height=t.height;const e=s.value;s.value=new Map;for(const[o]of e){u(n.find((t=>t.$.uid===o)))}e.forEach((t=>{t.disconnect()})),e.clear()}function u(t){!function(t){const e=s.value.get(t.$.uid);e&&(e.disconnect(),s.value.delete(t.$.uid))}(t);const e=function(t){const e=$(a,{thresholds:[0,.5]});return s.value.set(t.$.uid,e),e}(t),n=t.$.exposed;let l=n.stickyState.height+n.offsetTop;l+=44,i.height<=n.stickyState.height&&n.setPosition(!1,"absolute",0),e.relativeToViewport({top:-l}).observe(`#${o.value}`,(t=>{p(n,t)})),T(`#${o.value}`,!1,a).then((t=>{t.bottom=Number(t.bottom)+44,Number(t.bottom)<=l&&p(n,{boundingClientRect:t})})).catch((t=>{console.log(t)}))}function p(t,{boundingClientRect:e}){let o=t.offsetTop;o+=44;const s=t.stickyState.height+o;let i=e.bottom<=s;if(i=e.bottom<s,i)t.setPosition(!0,"absolute",e.height-t.stickyState.height);else if(e.top<=s&&!i){if("normal"===t.stickyState.state)return;t.setPosition(!1,"fixed",o)}}return l({boxStyle:i,observerForChild:u}),k((()=>{s.value=new Map})),(t,s)=>{const i=v;return b(),f(i,{style:{position:"relative"}},{default:m((()=>[w(i,{class:x(`wui-sticky-box ${e.customClass}`),style:y(t.customStyle),id:o.value},{default:m((()=>[w(_,{onResize:r},{default:m((()=>[g(t.$slots,"default",{},void 0,!0)])),_:3})])),_:3},8,["class","style","id"])])),_:3})}}})),[["__scopeId","data-v-a63f14a0"]]);export{F as _,M as a};
